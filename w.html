<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Images</title>
    <!-- Link to Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/css/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css">
    <link href="https://fonts.googleapis.com/css?family=Chivo:400,700,900|Signika+Negative:300,400,600,700" rel="stylesheet">
    <!-- Link to your Style CSS -->
    <link rel="stylesheet" href="style.css">
    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@latest/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
</head>

<body class="bg-primary">
    <!-- Spinner Modal -->
    <div class="modal fade" id="spinnerModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered justify-content-center">
            <div class="modal-content">
                <div class="modal-body">
                    <span class="fa fa-spinner fa-spin fa-3x"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container shadow p-3 mb-5 bg-body rounded">
        <!-- Search Row -->
        <div class="row bg-primary text-white py-2">
            <!-- VIN Search -->
            <div class="col-md-6">
                <div class="input-group">
                    <input name="VIN" id="VINbar" class="form-control" type="text" placeholder="Stock# - 8 Digits" aria-label="Search">
                    <button class="btn btn-warning" id="btn_submit">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </div>
            <!-- Link Search -->
            <div class="col-md-6">
                <div class="input-group">
                    <input name="LINK" id="LINKbar" class="form-control" type="text" placeholder="Copy image address and paste link here" aria-label="Search">
                    <button class="btn btn-warning" id="btn_submit2">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Navigation and Instructions -->
        <div class="row my-3">
            <div class="col-md-12">
                <nav aria-label="Photo Navigation">
                    <ul class="pagination justify-content-center">
                        <li class="page-item"><a class="page-link" href="#" onclick="prvs()">PREVIOUS</a></li>
                        <li class="page-item"><a class="page-link" href="#" onclick="nxt()">NEXT</a></li>
                        <li class="page-item"><a id="kmxlink" class="page-link" href="#" target="_blank">CarMax Page</a></li>
                    </ul>
                </nav>
                <div id="instructions">
                    <p><strong>Search Tool.<br>Navigate using Previous and Next buttons or jump to the image in the thumbnails below.</strong></p>
                </div>
                <img src="1.png" id="dispframe" alt="Display Frame" class="img-fluid my-3">
            </div>
        </div>

        <!-- Gallery -->
        <div class="row" id="gallery" data-bs-toggle="modal" data-bs-target="#exampleModal">
            <!-- Thumbnails -->
            <!-- Repeat this block for each thumbnail -->
            <div class="col-6 col-md-4 col-lg-3 mb-3">
                <img class="w-100" src="1.png" id="thumb1" alt="Thumbnail 1" onclick="thumbbtn(1)" style="cursor: pointer;">
            </div>
	    <div class="col-6 col-md-4 col-lg-3 mb-3">
                <img class="w-100" src="1.png" id="thumb2" alt="Thumbnail 2" onclick="thumbbtn(2)" style="cursor: pointer;">
            </div>
	    <div class="col-6 col-md-4 col-lg-3 mb-3">
                <img class="w-100" src="1.png" id="thumb3" alt="Thumbnail 3" onclick="thumbbtn(3)" style="cursor: pointer;">
            </div>
	    <div class="col-6 col-md-4 col-lg-3 mb-3">
                <img class="w-100" src="1.png" id="thumb4" alt="Thumbnail 4" onclick="thumbbtn(4)" style="cursor: pointer;">
            </div>
            <!-- ... other thumbnails ... -->
        </div>


    </div>	
	
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@latest/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>

<script>	
	
var countimg = 1;
var countimg1 = countimg + 1;
var countimg2 = countimg1 + 1;
var countimg3 = countimg2 + 1;
var countimg4 = countimg3 + 1;
var countimg5 = countimg4 + 1;
var countimg6 = countimg5 + 1;
var countimg7 = countimg6 + 1;
var countimg8 = countimg7 + 1;
var stocknum;
var stocknumchk;
	
document.getElementById("btn_submit").onclick = function () {
stocknum = document.getElementById("VINbar").value;
if (stocknum.length === 8) {
countimg = 1;
prvs();	
  } else {
       alert("Stock number should be 8 digits long, currently " + stocknum.length + " digits entered.");
  };
	
};

document.getElementById("btn_submit2").onclick = function () {
stocknum = document.getElementById("LINKbar").value;
stocknum = stocknum.replace("https:", "");
stocknum = stocknum.replace(/\//g, "");
stocknum = stocknum.replace("img2.carmax.comimgvehicles", "");	
//stocknum = stocknum.replace("1.jpg?cs=0&width=135", "");
stocknum = stocknum.replace("1.jpg?width=400&ratio=43", "");	
countimg = 1;
document.getElementById("VINbar").value = stocknum;
prvs();
};

	
function thumbbtn ( ordern ) { 
	countimg = countimg + ordern - 1;
	nxt();
}
	
function prvs() { 
	if (stocknum !== "" && typeof stocknum !== 'undefined') {
	if (countimg > 1) {
		countimg = countimg - 1;
		countimg1 = countimg + 1;
		countimg2 = countimg1 + 1;
		countimg3 = countimg2 + 1;
		countimg4 = countimg3 + 1;
		countimg5 = countimg4 + 1;
		countimg6 = countimg5 + 1;
		countimg7 = countimg6 + 1;
		countimg8 = countimg7 + 1;
	};
		displayimg();
	};
};

function nxt() {
	if (stocknum !== "" && typeof stocknum !== 'undefined') {
	countimg = countimg + 1;
	countimg1 = countimg + 1;
	countimg2 = countimg1 + 1;
	countimg3 = countimg2 + 1;
	countimg4 = countimg3 + 1;
	countimg5 = countimg4 + 1;
	countimg6 = countimg5 + 1;
	countimg7 = countimg6 + 1;
	countimg8 = countimg7 + 1;
	displayimg();
	};
};
	
function displayimg()
{
	console.log(countimg);
	document.getElementById("instructions").style.display = 'none';

	
	var x = document.getElementById("dispframe");
	var x1 = document.getElementById("thumb1");
	var x2 = document.getElementById("thumb2");
	var x3 = document.getElementById("thumb3");
	var x4 = document.getElementById("thumb4");

	var klink = document.getElementById("kmxlink");
  	
	klink.setAttribute("href", "https://www.carmax.com/car/"  + stocknum);
	if (stocknumchk !== stocknum) {
		stocknumchk = stocknum;
	}
	x.setAttribute("src", "https://img2.carmax.com/img/vehicles/" + stocknum + "/" + countimg + ".jpg");
	x.setAttribute("alt", countimg);
  	x.setAttribute("object-fit", "cover"); 
	
	if (!x.complete) {
		$('.modal').modal('show');
	}
	x.onload = function() {
	
	setTimeout(function () {
		$('.modal').modal('hide');
	}, 500);
	x1.setAttribute("src", "https://img2.carmax.com/img/vehicles/" + stocknum + "/" + countimg1 + ".jpg");
	x2.setAttribute("src", "https://img2.carmax.com/img/vehicles/" + stocknum + "/" + countimg2 + ".jpg");
	x3.setAttribute("src", "https://img2.carmax.com/img/vehicles/" + stocknum + "/" + countimg3 + ".jpg");
	x4.setAttribute("src", "https://img2.carmax.com/img/vehicles/" + stocknum + "/" + countimg4 + ".jpg");

	}
	
};
	
var input13 = document.getElementById("VINbar");
	
	input13.addEventListener("keyup", function(event) {
		if (event.keyCode === 13) {
			event.preventDefault();
			document.getElementById("btn_submit").click();
		}
	});
	
var input14 = document.getElementById("LINKbar");
	
	input14.addEventListener("keyup", function(event) {
		if (event.keyCode === 13) {
			event.preventDefault();
			document.getElementById("btn_submit2").click();
		}
	});
	


</script>
</body>
</html>
